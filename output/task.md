# AI Daily Lab â€” 2026-01-10

## Task
1. Generate a synthetic transactional pandas DataFrame (`transactions_df`) with 1200 rows. Columns should include:
    *   `transaction_id` (unique integers starting from 10000)
    *   `customer_id` (e.g., 100-150 distinct customer IDs, formatted as 'C' followed by a number)
    *   `transaction_date` (daily dates spanning 3 years, starting from '2021-01-01', ensuring multiple transactions per customer over time)
    *   `product_category` (e.g., 5 distinct string categories: 'Electronics', 'Books', 'Groceries', 'Clothing', 'Home Goods' with varying proportions)
    *   `amount` (random float values between 20.0 and 1000.0)
    *   Ensure the DataFrame is sorted by `customer_id` and then `transaction_date`.
2. Calculate the total revenue generated by each unique `customer_id`. Display the top 5 customers with the highest total revenue (customer ID and their total revenue).
3. Create a pivot table named `monthly_category_sales` that shows the total `amount` for each `product_category` (as columns) for each month and year combination (as index). Fill any missing values in the pivot table with 0. Display the head of this pivot table.
4. For each `customer_id`, calculate their 3-month rolling average `amount` (mean of `amount`) based on `transaction_date`. Store this as a new column `rolling_avg_3m_spend` in the original `transactions_df`. Ensure the rolling average is calculated *within each customer group* and correctly considers the time ordering. Display the head of the `transactions_df` including this new column.

## Focus
Pandas Data Manipulation, Aggregation, and Reshaping for Analytical Reporting

## Dataset
Synthetic transactional data generated with pandas and numpy.

## Hint
For step 3, extract the year-month part of `transaction_date` to use as the index for your pivot table. For step 4, remember to use `groupby('customer_id')` before applying `rolling(window='3M', on='transaction_date')` and `.mean()`. Make sure your `transaction_date` column is a datetime object before applying rolling windows.
